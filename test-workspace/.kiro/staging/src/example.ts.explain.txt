Added JSDoc comments and explicit TypeScript types using unified diff.